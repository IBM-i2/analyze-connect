<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Deploying a connector </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Deploying a connector ">
    <meta name="generator" content="docfx 2.56.2.0">
    
    <link rel="shortcut icon" href="../../images/favicon.png">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../../guidetoc/toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <strong>i2 Connect gateway</strong>
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
          
          <div class="subnav navbar navbar-default">
            <div class="container hide-when-search" id="breadcrumb">
              <ul class="breadcrumb">
                <li></li>
              </ul>
            </div>
          </div>
            <article class="content wrap" id="_content" data-uid="">
<h1 id="deploying-a-connector">Deploying a connector</h1>

<p>In this task, you deploy a minimal connector with a configuration endpoint that defines just one service. This is the minimum required for any connector to interact with the i2 Connect gateway.</p>
<p>If you have any issues during this task, the <a href="../miscellaneous/troubleshoot.html">troubleshooting guide</a> might be helpful.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Before you start, ensure that you have:</p>
<ul>
<li>deployed i2 Analyze with the i2 Connect gateway, and</li>
<li>defined a schema to model the data, and</li>
<li>installed Analyst&#39;s Notebook Premium and connected it to your i2 Analyze
deployment</li>
</ul>
<h2 id="adding-the-connector-to-the-i2-analyze-topology">Adding the connector to the i2 Analyze topology</h2>
<p>This is how to configure the i2 Analyze server so that it knows about your connector.</p>
<h3 id="add-the-connector-to-the-topologyxml">Add the connector to the topology.xml</h3>
<ol>
<li>In the <code>i2analyze</code> directory, navigate to the <code>toolkit\configuration\environment</code> directory and open the <code>topology.xml</code> file in a text editor.</li>
<li><p>In the <code>opal-services-daod</code> <code>&lt;war&gt;</code> element, if it is not already there, add a <code>&lt;connector-ids&gt;</code> element. Inside that, add a <code>&lt;connector-id&gt;</code> element with a <code>value</code> attribute that matches the unique identifier of your connector.
For example:</p>
<pre><code class="lang-xml">&lt;wars&gt;
  &lt;war ... name=&quot;opal-services-daod&quot; ... &gt;
    ...
    &lt;connector-ids&gt;
      &lt;connector-id value=&quot;nypd-connector&quot;/&gt;
    &lt;/connector-ids&gt;
    ...
  &lt;/war&gt;
&lt;/wars&gt;
</code></pre></li>
<li><p>Inside the <code>&lt;topology&gt;</code> element, add a <code>&lt;connectors&gt;</code> element. In here, add a <code>&lt;connector&gt;</code> element with <code>id</code>, <code>name</code>, and <code>base-url</code> attributes. Choose whatever <code>id</code> and <code>name</code> you like, but set the <code>base-url</code> to <code>http://localhost:9081/</code>. For example:</p>
<pre><code class="lang-xml">&lt;ns1:topology ...&gt;
  ...
  &lt;connectors&gt;
    &lt;connector base-url=&quot;http://localhost:9081/&quot; name=&quot;NYPD Connector&quot; id=&quot;nypd-connector&quot;/&gt;
  &lt;/connectors&gt;
&lt;/ns1:topology&gt;
</code></pre><p><strong>Note:</strong> If the schema is configured as a gateway schema, also add a <code>gateway-schema</code> attribute and set it to the schema short name.</p>
</li>
</ol>
<h3 id="reload-the-i2-analyze-configuration">Reload the i2 Analyze configuration</h3>
<p>For these changes to take effect, you need to update the i2 Analyze connectors configuration and use the Admin Console to reload it.</p>
<ol>
<li><p>Navigate to <code>i2analyze\toolkit\scripts</code> in your console and run:</p>
<pre><code class="lang-shell">setup -t updateConnectorsConfiguration
</code></pre></li>
<li><p>Open a web browser and navigate to <code>&lt;i2-Analyze-URL&gt;/admin#/connectors</code>, where <code>&lt;i2-Analyze-URL&gt;</code> is the URL used to access your i2 Analyze deployment.
For example, <code>http://localhost:9082/opaldaod/admin#/connectors</code>.</p>
<p><strong>Note:</strong> For more information about the Admin Console, refer to <a href="https://docs.i2group.com/analyze/admin-cac.html">i2 Analyze Server Admin Console</a>.</p>
</li>
<li><p>If you are prompted to log in, enter the credentials for your default user.
If you added an example user, the username and the password will be <code>Jenny</code>.</p>
</li>
<li><p>Click <strong>Reload gateway</strong> to enact your changes.</p>
</li>
</ol>
<h3 id="verify-the-connector-configuration">Verify the connector configuration</h3>
<p>To confirm that you successfully added a connector to the topology, you can view the status of your connectors using the Admin Console.
Although you don&#39;t yet have a running connector, you can test that you have configured i2 Analyze so that it can find the one you will soon create.</p>
<p>In the <strong>Connectors</strong> section, you can see a list of connectors that you deployed to your i2 Analyze server, and their respective statuses.
For the <code>nypd-connector</code>, there is an error with a message saying that i2 Analyze failed to retrieve configuration information for your connector, as shown below.
This is because the connector doesn&#39;t exist yet!</p>
<p><img src="images/admin-ui-config-error.png" alt="Admin user interface"></p>
<h3 id="unsecured-protocol-warning-message">Unsecured protocol warning message</h3>
<p>You might also see the following warning message in the Admin Console:</p>
<p><em>&quot;Configuration error for the connector with identifier &#39;&lt;CONNECTOR-ID>&#39;: The application is communicating with the connector through a protocol that is not secure.&quot;</em></p>
<p>In a development environment, you can ignore this warning.
It appears because i2 Analyze and your connector are communicating via HTTP rather than HTTPS.</p>
<p><strong>In a production environment, you should secure this connection using HTTPS.</strong> For information about configuring the connection to use HTTPS, see <a href="https://docs.i2group.com/analyze/t_connect_security.html">Client authenticated Secure Sockets Layer with the i2 Connect gateway</a>.</p>
<h2 id="deploying-the-connector">Deploying the connector</h2>
<p>Now that i2 Analyze is expecting a connector, you had better create one!
For the purposes of this guide, an example Spring Boot application is provided.</p>
<h3 id="set-up-the-example-starting-point">Set up the example starting point</h3>
<h4 id="java">Java</h4>
<ol>
<li><p>Open the example starting code from the <code>connector/nypd/java/template</code> folder in this repository.
Copy the <code>nypd-connector</code> directory to wherever you would like to work, and open it in VSCode or the IDE of your choice.</p>
<p><strong>Note:</strong> Ensure that the target directory contains no spaces in its path. Otherwise, you may face issues if you use the command prompt to start your connector.</p>
</li>
<li><p>Have a look at the contents:</p>
<ul>
<li>Resources: <code>config.json</code> and <code>application.properties</code></li>
<li>Code: a simple Spring Boot application</li>
</ul>
<p>The <code>config.json</code> file tells Analyst&#39;s Notebook what services are available and how to execute them.
For more information on providing this configuration, see <a href="../workflow/config.html">Implementing config</a>.</p>
<p>The <code>application.properties</code> file defines the server port.
In later walkthroughs, it also defines the resource URL and the API token required to connect to the resource.</p>
</li>
<li><p>Start the connector. See <a href="../example-connectors/run-java.html">running example connectors in Java</a>.</p>
</li>
</ol>
<h4 id="python">Python</h4>
<ol>
<li><p>Open the example starting code from the <code>connector/nypd/python/template/nypd-connector</code> folder in this repository.
Copy the <code>nypd-connector</code> directory to wherever you would like to work, and open it in VSCode or the IDE of your choice.</p>
</li>
<li><p>Have a look at the contents:</p>
<ul>
<li>Resources: <code>config.json</code></li>
<li>Code: a simple Flask application.</li>
</ul>
<p>The <code>config.json</code> file tells Analyst&#39;s Notebook what services are available and how to execute them.
For more information on providing this configuration, see <a href="../workflow/config.html">Implementing config</a>.</p>
</li>
<li><p>Start the connector through the <a href="../example-connectors/run-python.html">command line</a>.</p>
</li>
</ol>
<h3 id="use-postman-to-investigate-the-config-endpoint">Use Postman to investigate the config endpoint</h3>
<p>The supplied starting code has a <code>config</code> endpoint that is ready to use.</p>
<p>Using the provided Postman collections and environments, call the GET method of the <code>config</code> endpoint and look at the output.
Verify that it matches the contents of the <code>config.json</code> file that you set up earlier.</p>
<p>For more information on how to test your connector using Postman, see <a href="../miscellaneous/postman.html#testing-a-connector">this link</a>.</p>
<h3 id="update-the-i2-analyze-connectors-configuration">Update the i2 Analyze connectors configuration</h3>
<p>Now that you have a connector running, you need to tell i2 Analyze to reload its connector configurations.</p>
<ul>
<li>In the Admin Console, click <strong>Reload gateway</strong> to configure your changes.</li>
</ul>
<p>You can see that the &quot;Failed to retrieve configuration&quot; error has been replaced by another error.</p>
<p><img src="images/admin-ui-service-error.png" alt="Admin user interface"></p>
<h3 id="spi-version-warning-message">SPI version warning message</h3>
<p>You might also see the following warning message in the Admin Console:</p>
<p><em>&quot;The connector with identifier &#39;&lt;CONNECTOR-ID>&#39; did not specify an SPI version. Defaulting to version 1.0&quot;</em></p>
<p>To resolve this warning, the <code>config.json</code> file must specify the SPI version that the connector wants to use.
We will cover this setting in the next topic.</p>
<h3 id="investigate-in-analysts-notebook-premium">Investigate in Analyst&#39;s Notebook Premium</h3>
<p>Before you fix this issue, take a look at what happens when you try to use your connector from Analyst&#39;s Notebook Premium.</p>
<ol>
<li>Open Analyst&#39;s Notebook Premium and log in to the i2 Analyze server.</li>
<li>In the top ribbon, click the <strong>External Searches</strong> button.</li>
<li>Notice the banner at the top of the resulting window that says &quot;Some queries are not configured correctly&quot;.
This is because there are errors in your configuration, as shown in the Admin Console.</li>
</ol>
<h2 id="adding-a-service">Adding a service</h2>
<p>To enable the use of the connector, you must resolve all the errors displayed in the connector messages.
The error in this instance is caused by the connector not having any services.
The next step is therefore to <a href="4-add-service.html">define and implement a service</a>.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            &copy; N. Harris Computer Corporation.
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
